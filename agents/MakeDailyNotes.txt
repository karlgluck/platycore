      TITLE  "Make Daily Notes"
    RESERVE  7

--- EN ---

   SELECT  "C2"
     NAME  "EN"
 CHECKBOX  "FALSE"

   SELECT  "D2"
    VALUE  "EN"

--- ON ---

   SELECT  "C3"
     NAME  "ON"
 CHECKBOX  "TRUE"
        +  "READONLY"

   SELECT  "D3"
    VALUE  "ON"

--- GO ---

   SELECT  "C4"
     NAME  "GO"
 CHECKBOX  "FALSE"

   SELECT  "D4"
    VALUE  "GO"

--- WAKE ---

   SELECT  "H2:L2"
     NAME  "WAKE"
    STYLE  "READONLY_FIELD"
   EVALUE  "Lang.GetTimestampNowP() + 15000"
     LOAD  "WAKE", "OLD_AGENT"

   SELECT  "F2:G2"
    VALUE  "WAKE"

   SELECT  "F3:L3"
  FORMULA  "=(H2-(60*2+4)*1000)/1000/60/60/24+25568.6681"
   FORMAT  "DATETIME"

--- LOCK ---

   SELECT  "H5:L5"
     NAME  "LOCK"
    STYLE  "READONLY_FIELD"
   EVALUE  "Lang.GetTimestampNowP()"

   SELECT  "F5:G5"
    VALUE  "LOCK"

   SELECT  "F6:L6"
  FORMULA  "=(H5-(60*2+4)*1000)/1000/60/60/24+25568.6681"
   FORMAT  "DATETIME"

==================================================================
Agent-specific

This sets up a week with checkboxes

   SELECT "N2"
    VALUE "S"
   HALIGN "center"
   SELECT "N3"
     NAME "SCHEDULE_0S"
  CHECKBOX "FALSE"
     LOAD  "SCHEDULE_0S", "OLD_AGENT"

   SELECT "O2"
    VALUE "M"
   HALIGN "center"
   SELECT "O3"
     NAME "SCHEDULE_1M"
  CHECKBOX "TRUE"
     LOAD  "SCHEDULE_1M", "OLD_AGENT"

   SELECT "P2"
    VALUE "T"
   HALIGN "center"
   SELECT "P3"
     NAME "SCHEDULE_2T"
  CHECKBOX "TRUE"
     LOAD  "SCHEDULE_2T", "OLD_AGENT"

   SELECT "Q2"
    VALUE "W"
   HALIGN "center"
   SELECT "Q3"
     NAME "SCHEDULE_3w"
  CHECKBOX "TRUE"
     LOAD  "SCHEDULE_3w", "OLD_AGENT"

   SELECT "R2"
    VALUE "R"
   HALIGN "center"
   SELECT "R3"
     NAME "SCHEDULE_4R"
  CHECKBOX "TRUE"
     LOAD  "SCHEDULE_4R", "OLD_AGENT"

   SELECT "S2"
    VALUE "F"
   HALIGN "center"
   SELECT "S3"
     NAME "SCHEDULE_5F"
  CHECKBOX "TRUE"
     LOAD  "SCHEDULE_5F", "OLD_AGENT"

   SELECT "T2"
    VALUE "S"
   HALIGN "center"
   SELECT "T3"
     NAME "SCHEDULE_6S"
  CHECKBOX "FALSE"
     LOAD  "SCHEDULE_6S", "OLD_AGENT"


--- PRESENTATION_TEMPLATE_URL ---

   SELECT "V2:AD2"
    VALUE "presentation template:"
   HALIGN "right"

   SELECT "AE2:AV2"
     NAME "PRESENTATION_TEMPLATE_URL"
    STYLE "FIELD"
   HALIGN "right"
     LOAD "PRESENTATION_TEMPLATE_URL", "OLD_AGENT"

--- INPUT_SHEET_URL ---

   SELECT "V3:AD3"
    VALUE "input sheet:"
   HALIGN "right"

   SELECT "AE3:AV3"
     NAME "INPUT_SHEET_URL"
    STYLE "FIELD"
   HALIGN "right"
     LOAD "INPUT_SHEET_URL", "OLD_AGENT"

--- OUTPUT_FOLDER_URL ---

   SELECT "V4:AD4"
    VALUE "output folder:"
   HALIGN "right"

   SELECT "AE4:AV4"
     NAME "OUTPUT_FOLDER_URL"
    STYLE "FIELD"
   HALIGN "right"
     LOAD "OUTPUT_FOLDER_URL", "OLD_AGENT"

--- OUTPUT_TITLE ---

   SELECT "V5:AD5"
    VALUE "output title:"
   HALIGN "right"

   SELECT "AE5:AV5"
     NAME "OUTPUT_TITLE"
    STYLE "FIELD"
   HALIGN "right"
  FORMULA "=TEXT(NOW(),\"yy\")&TEXT(WEEKNUM(NOW()),\"00\")&\".\"&WEEKDAY(NOW())&\"-\"&TEXT(NOW(),\"mmdd\")"
     LOAD "OUTPUT_TITLE", "OLD_AGENT"


--- [Reinstall] ---

   SELECT "AS6:AV6"
    VALUE "[Reinstall]"
    STYLE "BUTTON"
     NOTE "---"
------------------------
      ALIAS "OLD_AGENT"
      EXPORT
      UNINSTALL
      NEW_AGENT "NEW_AGENT"
      SELECT "STACK"
      LOAD "REINSTALL_URL", "OLD_AGENT"
      INSTALL null
------------------------

   SELECT "AJ6:AR6"
     NAME "REINSTALL_URL"
    STYLE "FIELD"
     LOAD "$LAST_INSTALL_URL"



--- [Create] ---

   SELECT "O5:S5"
    VALUE "[Create]"
    STYLE "BUTTON"
     NOTE "---"
------------------------
   <      EVAL "---"
   ------------------------
   var presentation = SlidesApp.openByUrl('https://docs.google.com/presentation/d/1tyIfi-c8bUjrJvkaS22r23K6to1Sj6r52H8o8PZRFKU/edit#slide=id.SLIDES_API16818846_0')
   var agendaSlide = presentation.insertSlide(0, presentation.getLayouts()[2]);
   var [dayNumber, monthAndYear, agenda] = agendaSlide.getPageElements();
   dayNumber.asShape().getText().setText(Utilities.formatDate(new Date(), Session.getScriptTimeZone(), 'dd'));
   monthAndYear.asShape().getText().setText(Utilities.formatDate(new Date(), Session.getScriptTimeZone(), 'MMM yyyy').toUpperCase());
   var calendarEvents = CalendarApp.getEventsForDay(new Date());
   var agendaText = calendarEvents.map((e) => Utilities.formatDate(getStartTime(), Session.getScriptTimeZone(), 'HH:mm') + '\t' + e.getTitle()).join('\n');
   agenda.asShape().getText().setText(agendaText);
   presentation.saveAndClose();
   ------------------------
------------------------
